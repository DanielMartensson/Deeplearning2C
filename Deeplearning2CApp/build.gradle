buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'org.javafxports:jfxmobile-plugin:1.3.17'
    }
}

apply plugin: 'org.javafxports.jfxmobile'

repositories {
    jcenter()
    maven {
        url 'http://nexus.gluonhq.com/nexus/content/repositories/releases'
    }
}

mainClassName = 'se.danielmartensson.Main'

configurations {
     all*.exclude module: 'hdf5'
     all*.exclude module: 'hdf5-platform'
     all*.exclude module: 'leptonica'
     all*.exclude module: 'opencv'
     all*.exclude module: 'opencsv'
     all*.exclude module: 'datavec-data-image'
     all*.exclude module: 'deeplearning4j-ui-components'
     all*.exclude module: 'joda-time'
     all*.exclude module: 'gson'
     all*.exclude module: 'sneakeyaml'
     all*.exclude module: 'threetenbp'
     all*.exclude module: 'stax2-api'
     all*.exclude module: 'commons-net'
     all*.exclude module: 'neoitertools'
}

dependencies {
    compile 'com.gluonhq:charm:5.0.2'
    compile group: 'org.deeplearning4j', name: 'deeplearning4j-core', version: '1.0.0-beta4'
    compile group: 'org.nd4j', name: 'nd4j-native-platform', version: '1.0.0-beta4'
    compile group: 'org.datavec', name: 'datavec-api', version: '1.0.0-beta4'
    compile group: 'org.projectlombok', name: 'lombok', version: '1.18.8'
    compile group: 'ch.qos.logback', name: 'logback-classic', version: '1.2.3'
}

jfxmobile {
    downConfig {
        version = '3.8.6'
        // Do not edit the line below. Use Gluon Mobile Settings in your project context menu instead
        plugins 'display', 'lifecycle', 'statusbar', 'storage'
    }
    android {
        manifest = 'src/android/AndroidManifest.xml'
        targetSdkVersion = '28'
        dexOptions {
            additionalParameters = ['--minimal-main-dex']
            keepRuntimeAnnotatedClasses = false
            javaMaxHeapSize = '4g'
        }
        packagingOptions {
            exclude 'META-INF/DEPENDENCIES'
            exclude 'META-INF/DEPENDENCIES.txt'
            exclude 'META-INF/LICENSE'
            exclude 'META-INF/LICENSE.txt'
            exclude 'LICENSE-EDL-1.0.txt'
            exclude 'LICENSE-EPL-1.0.txt'
            exclude 'about.html'
            exclude 'META-INF/license.txt'
            exclude 'META-INF/NOTICE'
            exclude 'META-INF/NOTICE.txt'
            exclude 'META-INF/notice.txt'
            exclude 'META-INF/INDEX.LIST'
            exclude 'META-INF/services/javax.imageio.spi.ImageReaderSpi'
            exclude 'META-INF/services/javax.imageio.spi.ImageWriterSpi'
            exclude 'assets/org/apache/commons/math3/exception/util/LocalizedFormats_fr.properties'
            exclude 'assets/org/apache/commons/math3/random/new-joe-kuo-6.1000'
            exclude 'org/threeten/bp/format/ChronologyText.properties'
            exclude 'org/threeten/bp/TZDB.dat'
            pickFirst 'META-INF/services/org.nd4j.linalg.factory.Nd4jBackend'
            pickFirst 'META-INF/services/org.nd4j.linalg.compression.NDArrayCompressor'
            pickFirst 'nd4j-native.properties'
        }
    }
    ios {
        infoPList = file('src/ios/Default-Info.plist')
        forceLinkClasses = [
                'se.danielmartensson.**.*',
                'com.gluonhq.**.*',
                'javax.annotations.**.*',
                'javax.inject.**.*',
                'javax.json.**.*',
                'org.glassfish.json.**.*'
        ]
    }
}
